# ADVisionGNN  
**Unsupervised Industrial Anomaly Detection with Vision Graph Neural Network-based Autoencoder**  

---

# Table of Contents
1. [Introduction](#introduction)
2. [Proposed Architecture](#proposed-architecture)
   - [Training Process](#training-process)
   - [Inferring Process](#inferring-process)
3. [Features](#features)
4. [Dataset](#dataset)
5. [Results](#results)
6. [Installation](#installation)

---

# Introduction  
This project introduces ADVisionGNN, an innovative approach to unsupervised industrial anomaly detection, leveraging a **Vision Graph Neural Network (GNN) Encoder**. The architecture combines reconstruction-based techniques with distance-based methods for detecting anomalies with high precision.  

Although still under development, this framework aims to improve anomaly detection in industrial settings by providing robust and scalable methods for identifying irregularities.

---

# Proposed Architecture  

## Training Process  
- The **encoder** is designed to extract meaningful feature maps from input data. These features are stored in a **memory bank** built exclusively from normal samples, ensuring accurate anomaly detection.  
- The **decoder** focuses on reconstructing the feature maps back into the original image, facilitating anomaly identification.  

<div align="center">
  <img src="https://github.com/user-attachments/assets/1a5c0ae4-5ad8-4f6c-8e43-144dd4e4fc7d" 
    alt="Training Process" width="700"/>
</div>

## Inferring Process  
- The decoder's reconstruction is utilized to compute a **global anomaly score**, identifying regions of abnormality.  
- An **enhanced feature map** is generated by upscaling and assigning pixel-level anomaly scores.  
- The global anomaly score and pixel-level score map are **combined** to produce the final anomaly detection result.  

<div align="center">
  <img src="https://github.com/user-attachments/assets/f90850bc-8893-433a-8ef6-2bd01049b978" 
alt="Inferring Process" width="700"/>
</div>

---

# Features  
- Utilizes a **Vision Graph Neural Network (GNN) Encoder** for feature extraction.  
- Combines **reconstruction-based** and **distance-based** anomaly detection methods.  
- Robust **memory bank** system for modeling normal sample features.  
- Scalable architecture for industrial anomaly detection tasks.

---

# Dataset
- **MVTec AD**: A renowned dataset for industrial anomaly detection, containing 15 different classes: Bottle, Cable, Capsule, Carpet, Grid, Hazelnut, Leather, Metal Nut, Pill, Screw, Tile, Toothbrush, Transistor, Wood, Zipper.  

<div align="center">
    <img src="https://github.com/user-attachments/assets/98f5657d-8a2c-4279-8307-2ca9de2c5137" 
    alt="Dataset Overview" width="700"/>
</div>

- Future tests will include datasets such as **MVTec LOCO AD** and **BeanTech AD**.

---

# Results
- Current results achieved with the sample class **Carpet**:  

<div align="center">
    <img src="https://github.com/user-attachments/assets/6747c6d8-995b-4a8e-b12d-cd59ac2956fc" 
    alt="Results" width="700"/>
</div>

---

# Installation  
1. Clone the repository:  
   ```bash
   git clone https://github.com/JohnnysGithubAccount/ADVisionGNN
   cd ADVisionGNN
2. Run Mlflow GUI to check results:
    ```bash
   cd ADVisionGNN
    mlflow ui